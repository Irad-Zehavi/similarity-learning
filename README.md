similarity-learning
================

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## Install

``` sh
pip install similarity_learning
```

## How to use

As an nbdev library, `similarity_learning` supports `import *` (without
importing unwanted symbols):

``` python
from similarity_learning.all import *
```

Now we can train a pair-matcher. First let’s construct dataloaders of
pairs:

``` python
from fastai.vision.all import *

from fastai_datasets.all import *
```

``` python
pairs = Pairs(Imagenette(160), .1)
dls = pairs.dls(after_item=Resize(128),
                after_batch=Normalize.from_stats(*imagenet_stats))
```

    <div>
      <progress value='196' class='' max='196' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [196/196 00:00&lt;00:00]
    </div>
    

To get quick results, we can use the body of a pretrained model as a
backbone for our Siamese neural network:

``` python
classifier = resnet34(weights=ResNet34_Weights.DEFAULT)
siamese = ThresholdSiamese(create_body(model=classifier, cut=-1)).to(dls.device)
siamese.fit_threshold(dls.train)
```

    <div>
      <progress value='14' class='' max='14' style='width:300px; height:20px; vertical-align: middle;'></progress>
      100.00% [14/14 00:07&lt;00:00]
    </div>
    

    (0.9900000095367432, 0.8627232313156128)

Let’s see how good it is:

``` python
learn = Learner(dls, siamese, metrics=accuracy)
learn.validate()
```

    (#2) [0.5457545518875122,0.8520408272743225]

Not bad, but we can do better with finetuning:

``` python
learn.fit(5, 1e-4)
learn.validate()
```

    (#2) [0.30242323875427246,0.9234693646430969]
